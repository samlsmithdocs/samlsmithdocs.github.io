{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"SAMLSmith Guide","text":"<p>A guide to learning and using the SAMLSmith SAML response forging tool</p>"},{"location":"#overview","title":"Overview","text":"<p>SAMLSmith is a multi-purpose SAML response forging tool. It is designed to allow you to forge/spoof a SAML response from an identity provider (IdP).</p> <p>If you can forge a SAML reponse, you can effectively act as the identity provder, and gain access to the application [service provider] (SP) as any user in that system.</p> <p>The purpose of this guide is to help you understand SAML response forging, as well as how to perform it. Further, the guide contains some basic information about difference mechanisms of SAML and how they can, or cannot, defend against response forging.</p>"},{"location":"identityproviders/","title":"Identity Providers","text":"<p>Not every identity provider is susceptible to resposne forging. And even those that are may require a different level of work to obtain the private key material needed for response forging.</p> <p>Note that the ability to forge a SAML response from a specific identity provider does not make a statement about the overall security posture of the identity provider. As signing key material can be left \"laying around\" by administrators, finding the signing key material does not indicate that there is anything inherently insecure about the identity provider itself.</p> <p>At the core of it, for each identity provider you want to forge a response for, the identity provider must either:</p> <ul> <li>Offer a way to export the private key used for signing.</li> <li>Offer a way to import an external private key for signing.</li> </ul> <p>This document provides information on the following types of identity providers:</p> <ul> <li>Those where response forging has been tested with SAMLSmith.</li> <li>Those whose documentation shows that a it should be possible but have not been tested.</li> <li>Those whose documentation shows that it should not be possible to forge a SAML response.</li> </ul>"},{"location":"identityproviders/#samlsmith-tested","title":"SAMLSmith Tested","text":"<p>The following identity providers have had a response successfully forged by SAMLSmith</p>"},{"location":"identityproviders/#microsoft-entra-id","title":"Microsoft Entra ID","text":"<p>https://learn.microsoft.com/en-us/entra/identity/</p>"},{"location":"identityproviders/#pingidentity-pingone-for-workforce","title":"PingIdentity PingOne for Workforce","text":"<p>https://docs.pingidentity.com/pingone/release_notes/index.html</p>"},{"location":"identityproviders/#microsoft-active-directory-federation-services-ad-fs","title":"Microsoft Active Directory Federation Services (AD FS)","text":"<p>https://learn.microsoft.com/en-us/windows-server/identity/ad-fs/ad-fs-overview</p>"},{"location":"identityproviders/#jumpcloud","title":"Jumpcloud","text":"<p>https://jumpcloud.com/support/get-started</p>"},{"location":"identityproviders/#should-work-but-not-tested","title":"Should work but not tested","text":""},{"location":"identityproviders/#one-identity-onelogin","title":"One Identity OneLogin","text":"<p>https://onelogin.service-now.com/support?id=kb_view2</p> <p>According to the OneLogin documentation, support must set a flag on a OneLogin directory to permit the ability to upload a .pfx file for SAML response signing.</p> <p>In our demo environment used for exploratory testing, this was not enabled.</p>"},{"location":"identityproviders/#not-possible-as-far-as-we-know","title":"Not possible (as far as we know)","text":""},{"location":"identityproviders/#google-cloud-iam","title":"Google Cloud IAM","text":"<p>Google Cloud IAM provides the ability to roll certificates, but does not appear to offer the ability to import an external private key for signing.</p>"},{"location":"identityproviders/#okta","title":"Okta","text":"<p>Okta only supports an exteral keypair through the use of a CSR. Therefore, Okta is generating and holding the private key at all times. It is not possible to export the keypair through Okta APIs.</p>"}]}